# Reproducibility Materials

This GitHub repository contains codes and data to reproduce simulation results, figures, and real data analysis results from the paper "Large Precision Matrix Estimation with Unknown Group Structure".



## Package Environments

The codes in this repository requires R version 4.3.1 and the following R packages:

1. ```MASS 7.3.61```
2. ```pdfCluster 1.04```
3. ```Matrix 1.7.0```
4. ```glmnet 4.1.8```
5. ```glasso 1.11```
6. ```expm 0.999.9```
7. ```flare 1.7.0.1```
8. ```POET 2.0```
9. ```foreach 1.5.2```
10. ```doParallel 1.0.17```


### simulation-demo 

This folder contains the six demos to run the simulation examples introduced in Section 4 and Appendix B in the paper. By default, each demo will run every setting of that model for one replication for illustration purpose. The user can change the value of ```replication_time``` to specify the desired number of replications. The expected running time for each demo on a regular desktop PC should be within 5 minutes. 

### simulation-full  

This folder contains the codes to reproduce the full simulation results presented in Section 4 and Appendix B in the paper. As the full simulation results invovles multiple competing methods, various settings, and 200 replications, the codes utilized  parallel computing in order to reduce the running time. We would recommend to reproduce the full simulation results with a computing system of at least 24 cores and 500GB of storage. The following list provides the guidance for each file in the folder.

1. Table1.R will generate the result for the Table 1.
2. Table2.R will generate the result for the Table 2. 
3. Model 1.R will generate the result for the Table 3. 
4. Model 2.R will generate the result for the Table 4. 
5. Model 3.R will generate the result for the Table 5. 
6. Model 4.R will generate the result for the Table 6. 
7. Model 5.R will generate the result for the Table 7. 
8. Model 6.R will generate the result for the Table 1 in the Appendix B. 

### data

This folder contains the dataset for the real data analysis. The dataset is publicly avaliable at  https://bioinformatics.mdanderson.org/public-datasets/ . Please download the data file named "MDA133: Clinical Data and dChip MBEI value Files" from this link. 

"old.zip" in the folder contians the original data files downloaded from the above link. In this zip file, there are two excel documents named "MDA133CompleteInfo20070319.xls" and "MDA133PredictorTrainAndValidation.xls". We create the two data files used in the real data anlaysis as follows:

1.  We used the column "pCR" in "MDA133CompleteInfo20070319.xls" as our label which is the "label.csv". "label.csv" contians the true class labels.
2.  We deleted the header and genes name in "MDA133PredictorTrainAndValidation.xls" and built "data_breast.csv". "data_breast.csv" contains the breast cancel data we used in real data analysis.


### real-data-code  

This folder contrains the codes to reproduce the real data analysis results presented in Section 5 in the paper. 
1. plots.R will generate two plots. 1.png is Figure 1 in the paper. 2.png is Figure 2 in the paper.
2. real_data.R will generate the analysis results presented in Table 8. The codes will generate the Specificity, Sensitivity, and Matthews Correlation Coefficien (MCC) for each method over 100 stratified
samples.


### results  

This folder contains the results from running the code in the simulation-full folder and real-data-code folder. 

1. For a file named like "ModelX_a_b.csv" file, it records the errors for model X when n=a and p=b. The last two rows are column mean and column std.
2. For a file named like "table2_a_b.csv" file, it records the errors for table 2 when n=a and p=b. The last two rows are column mean and column std.
3. For "real_data_result.csv" file, it records the Specificity, Sensitivity, and Matthews Correlation Coefficien (MCC) for real data codes. The last two rows are column mean and column std.

### figures  

This folder contains Figures 1-2 in the paper. They are generated by plots.R in the real data file. The output contains the following two files.

1. 1.png is Figure 1 in the paper.
2. 2.png is Figure 2 in the paper.
